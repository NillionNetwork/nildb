{
  "id": "",
  "name": "variables.wallet.query.json",
  "schema": "",
  "variables": {
    "minAmount": {
      "type": "number",
      "description": "Minimum amount filter",
      "path": "$.pipeline[0].$match.amount.$gte"
    },
    "status": {
      "type": "string",
      "description": "Status to filter by",
      "path": "$.pipeline[0].$match.status"
    },
    "startDate": {
      "type": "date",
      "description": "Start date filter",
      "path": "$.pipeline[0].$match.timestamp.$gte"
    }
  },
  "pipeline": [
    {
      "$match": {
        "amount": {
          "$gte": "##minAmount"
        },
        "status": "##status",
        "timestamp": {
          "$gte": "##startDate"
        }
      }
    },
    {
      "$group": {
        "_id": "$status",
        "totalAmount": {
          "$sum": "$amount"
        },
        "count": {
          "$sum": 1
        }
      }
    },
    {
      "$sort": {
        "totalAmount": -1
      }
    }
  ]
}
